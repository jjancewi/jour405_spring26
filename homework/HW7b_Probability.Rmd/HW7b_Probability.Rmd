---
title: "HW7b_Probability"
output: html_document
---

---
title: "HW7b - Probability and the Normal Distribution"
---

In this assignment, you'll build on your z-score skills to answer probability questions using the normal distribution. You'll return to the White House salaries data and use it to answer the kinds of "what are the chances?" questions that come up in journalism all the time. This sets the stage for sampling, which we'll cover next.

### Task 1: Load the tidyverse and the data (1 point)

Load the tidyverse and the White House salaries data from https://raw.githubusercontent.com/dwillis/jour405/refs/heads/main/data/white_house_salaries_2025.csv into a dataframe called `wh_salaries`

```{r}
library(tidyverse)
wh_salaries <- read_csv("https://raw.githubusercontent.com/dwillis/jour405/refs/heads/main/data/white_house_salaries_2025.csv")
```

### Task 2: Filter and summarize (2 points)

You may remember from HW3 that some White House staffers have a salary of $0. Let's filter those out and focus on paid employees, saving the result to a new dataframe called `wh_paid`. You need to calculate the mean, median and standard deviation of the salary column using `wh_paid`:

```{r}
wh_paid <- wh_salaries |>
  filter(SALARY > 0)
mean_sal <- mean(wh_paid$SALARY)
median_sal <- median(wh_paid$SALARY)
sd_sal <- sd(wh_paid$SALARY)

```

Now create a histogram of the paid salaries with a vertical line for the mean and two more for ±1 standard deviation, similar to what you did in HW6 with Spotify data.

```{r}
wh_paid |> 
  ggplot() + 
  geom_histogram(aes(x = SALARY)) +
  geom_vline(aes(xintercept = mean(wh_paid$SALARY)), color = "red", linetype = "dashed")
```

**Describe the shape of the distribution. Is it roughly normal? Skewed? Where do most salaries cluster?**

I would say the shape of the distribution for this is skewed right. This is because most of the salaries are clustered around 70,000 to 125,000. The mean also falls within this range. However, the shape of the distribution is skewed because of the over 20 people who have salaries of almost 200000. This is skewed because those salaries are more than one standard deviation (40,342) away from the cluster.
### Task 3: The Empirical Rule (3 points)

The empirical rule (also called the 68-95-99.7 rule) says that for a normal distribution:
- About 68% of data falls within 1 standard deviation of the mean
- About 95% falls within 2 standard deviations
- About 99.7% falls within 3 standard deviations

Let's test this. We'll calculate the salary ranges for 1, 2, and 3 standard deviations from the mean, then count how many employees actually fall in each range.

```{r}
mean_sal <- mean(wh_paid$SALARY)
sd_sal <- sd(wh_paid$SALARY)
total_n <- nrow(wh_paid)

empirical <- tibble(
  range = c("Within 1 SD", "Within 2 SD", "Within 3 SD"),
  lower = c(mean_sal - sd_sal, mean_sal - 2 * sd_sal, mean_sal - 3 * sd_sal),
  upper = c(mean_sal + sd_sal, mean_sal + 2 * sd_sal, mean_sal + 3 * sd_sal),
  expected_pct = c(68, 95, 99.7),
  actual_count = c(
    sum(wh_paid$SALARY >= (mean_sal - sd_sal) & wh_paid$SALARY <= (mean_sal + sd_sal)),
    sum(wh_paid$SALARY >= (mean_sal - 2 * sd_sal) & wh_paid$SALARY <= (mean_sal + 2 * sd_sal)),
    sum(wh_paid$SALARY >= (mean_sal - 3 * sd_sal) & wh_paid$SALARY <= (mean_sal + 3 * sd_sal))
  ),
  actual_pct = round((actual_count / total_n) * 100, 1)
)

empirical
```

**How closely does the data follow the empirical rule? What does any deviation tell you about the distribution?**

The data follows the empirical rule pretty closely. It is only a few percentage points off from the expected percent. The only deviation is that both the actual percent of data within 1 Sd and 2 Sd are both lower than the expected. This is because of the cluster of employees just making under 200,000 which skews the data ever so slightly to the right.
### Task 4: From z-scores to probability with pnorm() (4 points)

Remember the car thefts z-score activity from class? Well, I want to return to that briefly, introduce a new tool called pnorm() and then apply it here. So open that CarTheftZScores notebook and, at the bottom, copy and paste in the contents here: https://gist.githubusercontent.com/dwillis/25102889f576b1707576b85e0be0c353/raw/1ca2be9636497cb5293ff7b1f4e6ed8e27a9e049/car_theft_pnorm.rmd

Re-run all of the blocks in CarTheftZScores notebook, including the code you just pasted in. What's happening there is you are using a function called `pnorm()` to find the probability of a value being less than or equal to a certain z-score. The basic formula to find that probability is:

```
1 - pnorm(z_score)
```

Where `z_score` is one row's z-score. Now apply the same approach to salaries.

Your editor asks: **"What's the probability that a randomly selected White House employee makes more than $150,000?"**

To answer this:
1. Calculate the z-score for $150,000
2. Use `pnorm()` to find the probability. `pnorm()` gives you the area under the normal curve to the LEFT of a z-score — that is, the probability of being BELOW that value.
3. Subtract from 1 to get the probability of being ABOVE $150,000
4. Check your answer against the actual data

```{r}

salary <- 150000
z_score <- (salary - mean_sal) / sd_sal

prob_less <- pnorm(z_score)
prob_more <- 1 - prob_less
prob_more

# Check against actual data
actual_prob <- sum(wh_paid$SALARY > 150000) / total_n
actual_prob
```

**Write a sentence describing this probability in plain English. How does the normal approximation (prob_less) compare to the actual percentage?**

The probability that a White House staffer makes more than $150,000 is roughly 16.9%. While the actual number of White House staffers that make more than $150,000 is roughly 18.1%. The normal approximation is close to the actual percentage, but only just a few percentage points off.
### Task 5: Probability between two values (3 points)

Now your editor asks: **"What percentage of White House employees make between $80,000 and $120,000?"**

You'll need to calculate z-scores for those two figures, use `pnorm()` for each, and subtract to find the probability between them. Update the REPLACE_ME figures with the appropriate numbers.

```{r}

z_lower <- (prob_less - mean_sal) / sd_sal
z_upper <- (prob_more - mean_sal) / sd_sal

prob_between <- pnorm(z_upper) - pnorm(z_lower)
prob_between

# Verify with actual data
actual_between <- sum(wh_paid$SALARY >= prob_more & wh_paid$SALARY <= prob_less) / total_n
actual_between

```

**Interpret this result. What does this "middle range" tell us about the White House salary structure?**

The actual between z score is at zero, which means the middle range is exactly the mean for the White House salary structure. However, the probabilty is way different at -1.45 z-score. This means the probabilty is well bellow the mean, which means the middle range is over one standard deviation away from the mean.
### Task 6: Expected vs. observed (3 points)

Let's compare what the normal distribution *predicts* to what we actually *see*. This idea — comparing expected to observed — is one you'll use again later in the course.

Create these salary bins and calculate the expected count (from the normal distribution) and the observed count (from the actual data) for each:

```{r}
bins <- tibble(
  category = c("Below $60k", "$60k-$90k", "$90k-$120k", "$120k-$150k", "Above $150k"),
  lower = c(-Inf, 60000, 90000, 120000, 150000),
  upper = c(60000, 90000, 120000, 150000, Inf)
) |>
  mutate(
    expected_pct = pnorm(upper, mean = mean_sal, sd = sd_sal) - pnorm(lower, mean = mean_sal, sd = sd_sal),
    expected_count = round(expected_pct * total_n, 1),
    observed_count = c(
      sum(wh_paid$SALARY < 60000),
      sum(wh_paid$SALARY >= 60000 & wh_paid$SALARY < 90000),
      sum(wh_paid$SALARY >= 90000 & wh_paid$SALARY < 120000),
      sum(wh_paid$SALARY >= 120000 & wh_paid$SALARY < 150000),
      sum(wh_paid$SALARY >= 150000)
    ),
    difference = observed_count - expected_count
  )

bins |> select(category, expected_count, observed_count, difference)
```

**Where does reality differ most from what the normal distribution predicts? What might explain those differences?**

The most where reality differs is at the second to most bottom category of $60k - $90k. The difference in expected to observed is 73.0. The normal distribution predicts a gradual rise up of salaries to the mean salary range, and then a gradual fall down. In real life, more people are earning lower wages than expected in a normal distribution. This means many of the white house staffers are actually being underpaid compared to what their predicted salary should be. 
### Task 7: Story pitch (4 points)

Based on your probability analysis, write a headline and lede for a story about White House salaries. Your lede should incorporate at least one probability or percentage you calculated.

Then write 2-3 sentences describing how you would use probability thinking to advance this story — what could you compare these probabilities to, and what additional analysis would help?

Many White House staffers are being underpaid for their work, data shows.

Out of the 396 white house staffers the "middle range" of salaries is more than one standard deviation lower than expected at -1.45. This is because the probability a White House staffer makes less than $150,000 is at 83.1%.

The next thing I would do in the story is the probability for when the White House staffers were hired. Were they all hired in the same couple of months. Furthermore, I would then try to calculate the age of the white house staffers, are the people with more seniority in government getting higher wages? I would compare these probabilities to Congressional Staffers since the last Congress. Other data and analysis that would help would be looking back at previous white house staffs for previous Presidents, and seeing what that data/probability looks like compared to this one.
### Task 8: Save Your Work and Put it on GitHub

Save this notebook, then commit it to your local repository. Push the changes to your GitHub repository and submit the URL for this file in ELMS.
